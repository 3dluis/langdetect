import unittest

from langdetect.utils.ngram import NGram


class NGramTest(unittest.TestCase):
    def test_constants(self):
        self.assertEqual(NGram.N_GRAM, 3)

    def test_normalize_with_latin(self):
        self.assertEqual(NGram.normalize(u'\u0000'), ' ')
        self.assertEqual(NGram.normalize(u'\u0009'), ' ')
        self.assertEqual(NGram.normalize(u'\u0020'), ' ')
        self.assertEqual(NGram.normalize(u'\u0030'), ' ')
        self.assertEqual(NGram.normalize(u'\u0040'), ' ')
        self.assertEqual(NGram.normalize(u'\u0041'), u'\u0041')
        self.assertEqual(NGram.normalize(u'\u005a'), u'\u005a')
        self.assertEqual(NGram.normalize(u'\u005b'), ' ')
        self.assertEqual(NGram.normalize(u'\u0060'), ' ')
        self.assertEqual(NGram.normalize(u'\u0061'), u'\u0061')
        self.assertEqual(NGram.normalize(u'\u007a'), u'\u007a')
        self.assertEqual(NGram.normalize(u'\u007b'), ' ')
        self.assertEqual(NGram.normalize(u'\u007f'), ' ')
        self.assertEqual(NGram.normalize(u'\u0080'), u'\u0080')
        self.assertEqual(NGram.normalize(u'\u00a0'), ' ')
        self.assertEqual(NGram.normalize(u'\u00a1'), u'\u00a1')

    def test_normalize_with_cjk_kanji(self):
        self.assertEqual(NGram.normalize(u'\u4E00'), u'\u4E00')
        self.assertEqual(NGram.normalize(u'\u4E01'), u'\u4E01')
        self.assertEqual(NGram.normalize(u'\u4E02'), u'\u4E02')
        self.assertEqual(NGram.normalize(u'\u4E03'), u'\u4E01')
        self.assertEqual(NGram.normalize(u'\u4E04'), u'\u4E04')
        self.assertEqual(NGram.normalize(u'\u4E05'), u'\u4E05')
        self.assertEqual(NGram.normalize(u'\u4E06'), u'\u4E06')
        self.assertEqual(NGram.normalize(u'\u4E07'), u'\u4E07')
        self.assertEqual(NGram.normalize(u'\u4E08'), u'\u4E08')
        self.assertEqual(NGram.normalize(u'\u4E09'), u'\u4E09')
        self.assertEqual(NGram.normalize(u'\u4E10'), u'\u4E10')
        self.assertEqual(NGram.normalize(u'\u4E11'), u'\u4E11')
        self.assertEqual(NGram.normalize(u'\u4E12'), u'\u4E12')
        self.assertEqual(NGram.normalize(u'\u4E13'), u'\u4E13')
        self.assertEqual(NGram.normalize(u'\u4E14'), u'\u4E14')
        self.assertEqual(NGram.normalize(u'\u4E15'), u'\u4E15')
        self.assertEqual(NGram.normalize(u'\u4E1e'), u'\u4E1e')
        self.assertEqual(NGram.normalize(u'\u4E1f'), u'\u4E1f')
        self.assertEqual(NGram.normalize(u'\u4E20'), u'\u4E20')
        self.assertEqual(NGram.normalize(u'\u4E21'), u'\u4E21')
        self.assertEqual(NGram.normalize(u'\u4E22'), u'\u4E22')
        self.assertEqual(NGram.normalize(u'\u4E23'), u'\u4E23')
        self.assertEqual(NGram.normalize(u'\u4E24'), u'\u4E13')
        self.assertEqual(NGram.normalize(u'\u4E25'), u'\u4E13')
        self.assertEqual(NGram.normalize(u'\u4E30'), u'\u4E30')

    def test_normalize_for_romanian(self):
        self.assertEqual(NGram.normalize(u'\u015f'), u'\u015f')
        self.assertEqual(NGram.normalize(u'\u0163'), u'\u0163')
        self.assertEqual(NGram.normalize(u'\u0219'), u'\u015f')
        self.assertEqual(NGram.normalize(u'\u021b'), u'\u0163')

    def test_ngram(self):
        ngram = NGram()
        self.assertIsNone(ngram.get(0))
        self.assertIsNone(ngram.get(1))
        self.assertIsNone(ngram.get(2))
        self.assertIsNone(ngram.get(3))
        self.assertIsNone(ngram.get(4))
        ngram.add_char(' ')
        self.assertIsNone(ngram.get(1))
        self.assertIsNone(ngram.get(2))
        self.assertIsNone(ngram.get(3))
        ngram.add_char('A')
        self.assertEqual(ngram.get(1), 'A')
        self.assertEqual(ngram.get(2), ' A')
        self.assertIsNone(ngram.get(3))
        ngram.add_char(u'\u06cc')
        self.assertEqual(ngram.get(1), u'\u064a')
        self.assertEqual(ngram.get(2), u'A\u064a')
        self.assertEqual(ngram.get(3), u' A\u064a')
        ngram.add_char(u'\u1ea0')
        self.assertEqual(ngram.get(1), u'\u1ec3')
        self.assertEqual(ngram.get(2), u'\u064a\u1ec3')
        self.assertEqual(ngram.get(3), u'A\u064a\u1ec3')
        ngram.add_char(u'\u3044')
        self.assertEqual(ngram.get(1), u'\u3042')
        self.assertEqual(ngram.get(2), u'\u1ec3\u3042')
        self.assertEqual(ngram.get(3), u'\u064a\u1ec3\u3042')

        ngram.add_char(u'\u30a4')
        self.assertEqual(ngram.get(1), u'\u30a2')
        self.assertEqual(ngram.get(2), u'\u3042\u30a2')
        self.assertEqual(ngram.get(3), u'\u1ec3\u3042\u30a2')
        ngram.add_char(u'\u3106')
        self.assertEqual(ngram.get(1), u'\u3105')
        self.assertEqual(ngram.get(2), u'\u30a2\u3105')
        self.assertEqual(ngram.get(3), u'\u3042\u30a2\u3105')
        ngram.add_char(u'\uac01')
        self.assertEqual(ngram.get(1), u'\uac00')
        self.assertEqual(ngram.get(2), u'\u3105\uac00')
        self.assertEqual(ngram.get(3), u'\u30a2\u3105\uac00')
        ngram.add_char(u'\u2010')
        self.assertIsNone(ngram.get(1))
        self.assertEqual(ngram.get(2), u'\uac00 ')
        self.assertEqual(ngram.get(3), u'\u3105\uac00 ')

        ngram.add_char('a')
        self.assertEqual(ngram.get(1), 'a')
        self.assertEqual(ngram.get(2), ' a')
        self.assertIsNone(ngram.get(3))

    def test_ngram3(self):
        ngram = NGram()

        ngram.add_char('A')
        self.assertEqual(ngram.get(1), 'A')
        self.assertEqual(ngram.get(2), ' A')
        self.assertIsNone(ngram.get(3))

        ngram.add_char('1')
        self.assertIsNone(ngram.get(1))
        self.assertEqual(ngram.get(2), 'A ')
        self.assertEqual(ngram.get(3), ' A ')

        ngram.add_char('B')
        self.assertEqual(ngram.get(1), 'B')
        self.assertEqual(ngram.get(2), ' B')
        self.assertIsNone(ngram.get(3))

    def test_normalize_vietnamese(self):
        self.assertEqual(NGram.normalize_vi(u''), '')
        self.assertEqual(NGram.normalize_vi(u'ABC'), 'ABC')
        self.assertEqual(NGram.normalize_vi(u'012'), '012')
        self.assertEqual(NGram.normalize_vi(u'\u00c0'), u'\u00c0')

        self.assertEqual(NGram.normalize_vi(u'\u0041\u0300'), u'\u00C0')
        self.assertEqual(NGram.normalize_vi(u'\u0045\u0300'), u'\u00C8')
        self.assertEqual(NGram.normalize_vi(u'\u0049\u0300'), u'\u00CC')
        self.assertEqual(NGram.normalize_vi(u'\u004F\u0300'), u'\u00D2')
        self.assertEqual(NGram.normalize_vi(u'\u0055\u0300'), u'\u00D9')
        self.assertEqual(NGram.normalize_vi(u'\u0059\u0300'), u'\u1EF2')
        self.assertEqual(NGram.normalize_vi(u'\u0061\u0300'), u'\u00E0')
        self.assertEqual(NGram.normalize_vi(u'\u0065\u0300'), u'\u00E8')
        self.assertEqual(NGram.normalize_vi(u'\u0069\u0300'), u'\u00EC')
        self.assertEqual(NGram.normalize_vi(u'\u006F\u0300'), u'\u00F2')
        self.assertEqual(NGram.normalize_vi(u'\u0075\u0300'), u'\u00F9')
        self.assertEqual(NGram.normalize_vi(u'\u0079\u0300'), u'\u1EF3')
        self.assertEqual(NGram.normalize_vi(u'\u00C2\u0300'), u'\u1EA6')
        self.assertEqual(NGram.normalize_vi(u'\u00CA\u0300'), u'\u1EC0')
        self.assertEqual(NGram.normalize_vi(u'\u00D4\u0300'), u'\u1ED2')
        self.assertEqual(NGram.normalize_vi(u'\u00E2\u0300'), u'\u1EA7')
        self.assertEqual(NGram.normalize_vi(u'\u00EA\u0300'), u'\u1EC1')
        self.assertEqual(NGram.normalize_vi(u'\u00F4\u0300'), u'\u1ED3')
        self.assertEqual(NGram.normalize_vi(u'\u0102\u0300'), u'\u1EB0')
        self.assertEqual(NGram.normalize_vi(u'\u0103\u0300'), u'\u1EB1')
        self.assertEqual(NGram.normalize_vi(u'\u01A0\u0300'), u'\u1EDC')
        self.assertEqual(NGram.normalize_vi(u'\u01A1\u0300'), u'\u1EDD')
        self.assertEqual(NGram.normalize_vi(u'\u01AF\u0300'), u'\u1EEA')
        self.assertEqual(NGram.normalize_vi(u'\u01B0\u0300'), u'\u1EEB')

        self.assertEqual(NGram.normalize_vi(u'\u0041\u0301'), u'\u00C1')
        self.assertEqual(NGram.normalize_vi(u'\u0045\u0301'), u'\u00C9')
        self.assertEqual(NGram.normalize_vi(u'\u0049\u0301'), u'\u00CD')
        self.assertEqual(NGram.normalize_vi(u'\u004F\u0301'), u'\u00D3')
        self.assertEqual(NGram.normalize_vi(u'\u0055\u0301'), u'\u00DA')
        self.assertEqual(NGram.normalize_vi(u'\u0059\u0301'), u'\u00DD')
        self.assertEqual(NGram.normalize_vi(u'\u0061\u0301'), u'\u00E1')
        self.assertEqual(NGram.normalize_vi(u'\u0065\u0301'), u'\u00E9')
        self.assertEqual(NGram.normalize_vi(u'\u0069\u0301'), u'\u00ED')
        self.assertEqual(NGram.normalize_vi(u'\u006F\u0301'), u'\u00F3')
        self.assertEqual(NGram.normalize_vi(u'\u0075\u0301'), u'\u00FA')
        self.assertEqual(NGram.normalize_vi(u'\u0079\u0301'), u'\u00FD')
        self.assertEqual(NGram.normalize_vi(u'\u00C2\u0301'), u'\u1EA4')
        self.assertEqual(NGram.normalize_vi(u'\u00CA\u0301'), u'\u1EBE')
        self.assertEqual(NGram.normalize_vi(u'\u00D4\u0301'), u'\u1ED0')
        self.assertEqual(NGram.normalize_vi(u'\u00E2\u0301'), u'\u1EA5')
        self.assertEqual(NGram.normalize_vi(u'\u00EA\u0301'), u'\u1EBF')
        self.assertEqual(NGram.normalize_vi(u'\u00F4\u0301'), u'\u1ED1')
        self.assertEqual(NGram.normalize_vi(u'\u0102\u0301'), u'\u1EAE')
        self.assertEqual(NGram.normalize_vi(u'\u0103\u0301'), u'\u1EAF')
        self.assertEqual(NGram.normalize_vi(u'\u01A0\u0301'), u'\u1EDA')
        self.assertEqual(NGram.normalize_vi(u'\u01A1\u0301'), u'\u1EDB')
        self.assertEqual(NGram.normalize_vi(u'\u01AF\u0301'), u'\u1EE8')
        self.assertEqual(NGram.normalize_vi(u'\u01B0\u0301'), u'\u1EE9')

        self.assertEqual(NGram.normalize_vi(u'\u0041\u0303'), u'\u00C3')
        self.assertEqual(NGram.normalize_vi(u'\u0045\u0303'), u'\u1EBC')
        self.assertEqual(NGram.normalize_vi(u'\u0049\u0303'), u'\u0128')
        self.assertEqual(NGram.normalize_vi(u'\u004F\u0303'), u'\u00D5')
        self.assertEqual(NGram.normalize_vi(u'\u0055\u0303'), u'\u0168')
        self.assertEqual(NGram.normalize_vi(u'\u0059\u0303'), u'\u1EF8')
        self.assertEqual(NGram.normalize_vi(u'\u0061\u0303'), u'\u00E3')
        self.assertEqual(NGram.normalize_vi(u'\u0065\u0303'), u'\u1EBD')
        self.assertEqual(NGram.normalize_vi(u'\u0069\u0303'), u'\u0129')
        self.assertEqual(NGram.normalize_vi(u'\u006F\u0303'), u'\u00F5')
        self.assertEqual(NGram.normalize_vi(u'\u0075\u0303'), u'\u0169')
        self.assertEqual(NGram.normalize_vi(u'\u0079\u0303'), u'\u1EF9')
        self.assertEqual(NGram.normalize_vi(u'\u00C2\u0303'), u'\u1EAA')
        self.assertEqual(NGram.normalize_vi(u'\u00CA\u0303'), u'\u1EC4')
        self.assertEqual(NGram.normalize_vi(u'\u00D4\u0303'), u'\u1ED6')
        self.assertEqual(NGram.normalize_vi(u'\u00E2\u0303'), u'\u1EAB')
        self.assertEqual(NGram.normalize_vi(u'\u00EA\u0303'), u'\u1EC5')
        self.assertEqual(NGram.normalize_vi(u'\u00F4\u0303'), u'\u1ED7')
        self.assertEqual(NGram.normalize_vi(u'\u0102\u0303'), u'\u1EB4')
        self.assertEqual(NGram.normalize_vi(u'\u0103\u0303'), u'\u1EB5')
        self.assertEqual(NGram.normalize_vi(u'\u01A0\u0303'), u'\u1EE0')
        self.assertEqual(NGram.normalize_vi(u'\u01A1\u0303'), u'\u1EE1')
        self.assertEqual(NGram.normalize_vi(u'\u01AF\u0303'), u'\u1EEE')
        self.assertEqual(NGram.normalize_vi(u'\u01B0\u0303'), u'\u1EEF')

        self.assertEqual(NGram.normalize_vi(u'\u0041\u0309'), u'\u1EA2')
        self.assertEqual(NGram.normalize_vi(u'\u0045\u0309'), u'\u1EBA')
        self.assertEqual(NGram.normalize_vi(u'\u0049\u0309'), u'\u1EC8')
        self.assertEqual(NGram.normalize_vi(u'\u004F\u0309'), u'\u1ECE')
        self.assertEqual(NGram.normalize_vi(u'\u0055\u0309'), u'\u1EE6')
        self.assertEqual(NGram.normalize_vi(u'\u0059\u0309'), u'\u1EF6')
        self.assertEqual(NGram.normalize_vi(u'\u0061\u0309'), u'\u1EA3')
        self.assertEqual(NGram.normalize_vi(u'\u0065\u0309'), u'\u1EBB')
        self.assertEqual(NGram.normalize_vi(u'\u0069\u0309'), u'\u1EC9')
        self.assertEqual(NGram.normalize_vi(u'\u006F\u0309'), u'\u1ECF')
        self.assertEqual(NGram.normalize_vi(u'\u0075\u0309'), u'\u1EE7')
        self.assertEqual(NGram.normalize_vi(u'\u0079\u0309'), u'\u1EF7')
        self.assertEqual(NGram.normalize_vi(u'\u00C2\u0309'), u'\u1EA8')
        self.assertEqual(NGram.normalize_vi(u'\u00CA\u0309'), u'\u1EC2')
        self.assertEqual(NGram.normalize_vi(u'\u00D4\u0309'), u'\u1ED4')
        self.assertEqual(NGram.normalize_vi(u'\u00E2\u0309'), u'\u1EA9')
        self.assertEqual(NGram.normalize_vi(u'\u00EA\u0309'), u'\u1EC3')
        self.assertEqual(NGram.normalize_vi(u'\u00F4\u0309'), u'\u1ED5')
        self.assertEqual(NGram.normalize_vi(u'\u0102\u0309'), u'\u1EB2')
        self.assertEqual(NGram.normalize_vi(u'\u0103\u0309'), u'\u1EB3')
        self.assertEqual(NGram.normalize_vi(u'\u01A0\u0309'), u'\u1EDE')
        self.assertEqual(NGram.normalize_vi(u'\u01A1\u0309'), u'\u1EDF')
        self.assertEqual(NGram.normalize_vi(u'\u01AF\u0309'), u'\u1EEC')
        self.assertEqual(NGram.normalize_vi(u'\u01B0\u0309'), u'\u1EED')

        self.assertEqual(NGram.normalize_vi(u'\u0041\u0323'), u'\u1EA0')
        self.assertEqual(NGram.normalize_vi(u'\u0045\u0323'), u'\u1EB8')
        self.assertEqual(NGram.normalize_vi(u'\u0049\u0323'), u'\u1ECA')
        self.assertEqual(NGram.normalize_vi(u'\u004F\u0323'), u'\u1ECC')
        self.assertEqual(NGram.normalize_vi(u'\u0055\u0323'), u'\u1EE4')
        self.assertEqual(NGram.normalize_vi(u'\u0059\u0323'), u'\u1EF4')
        self.assertEqual(NGram.normalize_vi(u'\u0061\u0323'), u'\u1EA1')
        self.assertEqual(NGram.normalize_vi(u'\u0065\u0323'), u'\u1EB9')
        self.assertEqual(NGram.normalize_vi(u'\u0069\u0323'), u'\u1ECB')
        self.assertEqual(NGram.normalize_vi(u'\u006F\u0323'), u'\u1ECD')
        self.assertEqual(NGram.normalize_vi(u'\u0075\u0323'), u'\u1EE5')
        self.assertEqual(NGram.normalize_vi(u'\u0079\u0323'), u'\u1EF5')
        self.assertEqual(NGram.normalize_vi(u'\u00C2\u0323'), u'\u1EAC')
        self.assertEqual(NGram.normalize_vi(u'\u00CA\u0323'), u'\u1EC6')
        self.assertEqual(NGram.normalize_vi(u'\u00D4\u0323'), u'\u1ED8')
        self.assertEqual(NGram.normalize_vi(u'\u00E2\u0323'), u'\u1EAD')
        self.assertEqual(NGram.normalize_vi(u'\u00EA\u0323'), u'\u1EC7')
        self.assertEqual(NGram.normalize_vi(u'\u00F4\u0323'), u'\u1ED9')
        self.assertEqual(NGram.normalize_vi(u'\u0102\u0323'), u'\u1EB6')
        self.assertEqual(NGram.normalize_vi(u'\u0103\u0323'), u'\u1EB7')
        self.assertEqual(NGram.normalize_vi(u'\u01A0\u0323'), u'\u1EE2')
        self.assertEqual(NGram.normalize_vi(u'\u01A1\u0323'), u'\u1EE3')
        self.assertEqual(NGram.normalize_vi(u'\u01AF\u0323'), u'\u1EF0')
        self.assertEqual(NGram.normalize_vi(u'\u01B0\u0323'), u'\u1EF1')
